{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "id": "http://api.npolar.no/schema/dataset-0.10",
  "title": "Dataset",
  "description": "Metadata describing a dataset",
  "type": "object",   
  "additionalProperties": false,
  "required": ["title", "schema", "topics", "licences"],
  "properties": {
    "id": { "description": "Identifier (UUID | URI)", "type": "string" },
    "title": { "description": "Title should be specific enough to make sense out of context", "type": "string"},
    "schema": { "type": "string", "description": "JSON schema URI"},
    "summary": { "description": "Abstract", "type": "string"},
    "draft": { "type": "string", "enum": ["yes", "no"]},
    "coverage": {
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "north": { "type": "number", "minimum": -90.0, "maximum": 90.0 },
          "east": { "type": "number", "minimum": -180.0, "maximum": 180.0 },
          "south": { "type": "number", "minimum": -90.0, "maximum": 90.0 },
          "west": { "type": "number", "minimum": -180.0, "maximum": 180.0 }
        }
      }
    },
    "progress": { "type": ["string", "null"], "enum": ["ongoing","complete", "planned", null]},
    "topics": {
      "title": "NPI topics",
      "description": "Based on http://www.npolar.no/en/research/topics/ supplemented with 'maps', 'service', 'other' and 'topography'. Management? Conservation? Atmosphere/met?",
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "string",
        "enum": ["biology", "ecotoxicology", "geology", "geophysics", "glaciology", "maps", "oceanography", "other", "seaice", "service", "topography"]
      }
    },
    "iso_topics": {
      "title": "ISO topic categories",
      "description": "http://www.isotc211.org/2005/resources/Codelist/gmxCodelists.xml",
      "type": ["array","null"],
      "additionalItems": false,
      "items": {
        "type": "string",
        "enum": ["biota", "boundaries", "climatologyMeteorologyAtmosphere", "economy", "elevation", "environment", "farming", "geoscientificInformation", "health", "imageryBaseMapsEarthCover", "inlandWaters", "intelligenceMilitary", "location", "oceans", "planningCadastre", "society", "structure", "transportation", "utilitiesCommunication"] 
      }
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" }
    },
    "licences": {
      "title": "Licence URIs",
      "type": "array",
      "additionalItems": false,
      "default": ["http://data.norge.no/nlod/no/1.0"],
      "items": {
        "type": "string",
        "enum": ["http://data.norge.no/nlod/no/1.0", "http://creativecommons.org/licences/by/3.0/no/", "http://opendatacommons.org/licenses/by/1.0/", "http://www.lovdata.no/all/hl-19610512-002.html"]
      }
    },
    "edits": {
      "description": "List of edits",
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "edited": {
            "type": "string",
            "format": "date-time"
          },
          "email": { "type": "string" },
          "name": { "type": "string" }
        },
        "required": ["edited", "name"]
      }
    },
    "people": {
      "description": "People involved in creating the dataset, roles from http://www.isotc211.org/2005/resources/Codelist/gmxCodelists.xml with 'editor' (meaning metadata editor) added",
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "first_name": { "type": "string" },
          "last_name": { "type": "string" },
          "roles": {
            "type": "array",
            "items": {
              "enum": ["principalInvestigator", "processor", "pointOfContact", "editor"]
            }
          },
          "email": {
            "type": ["string","null"],
            "additionalItems": false
          },
          "href": {
            "type": ["string","null"],
            "additionalItems": false
          },
          "affiliation": { "type": "object",
            "additionalProperties": true,
            "properties": {
              "name": { "type": "string" },
              "href": { "type": "string", "format": "uri" }
            }
          }
        },
        "required": ["first_name", "last_name", "roles"]
      }
    },

    "organisations": {
      "description": "Organisations connected to the dataset",
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "name": { "type": "string" },
          "gcmd_short_name": { "type": ["string", "null"] },
          "shortname": { "type": ["string", "null"] },
          "roles": {
            "type": "array",
            "items": {
              "enum": ["originator", "owner",  "publisher", "resourceProvider"]
            }
          },
          "email": {
            "type": ["string","null"],
            "additionalItems": false,
            "format": "email"
          },
          "uri": {
            "type": ["string","null"],
            "additionalItems": false
          }
        },
        "required": ["name", "roles", "uri"]
      }
    },
    "links": {
      "description": "Links to data, references, project, parent, doi, related, self, alternate. See Atom Format",
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "rel": { "type": "string" },
          "href": { "type": "string", "format": "uri" },
          "title": { "type": ["string", "null"] },
          "hreflang": { "type": ["string", "null"] },
          "type": { "type": "string" }
        },
        "required": ["rel", "href"]
      }
    },
    "category": {
      "description": "",
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "term": { "type": "string"},
          "schema": { "type": "string", "format": "uri", "default":"http://api.npolar.no/schema/category" },
          "title": { "type": "string" },
          "label": { "type": "string" },
          "lang": { "type": "string", "pattern": "^[a-z]{2}$" }
        },
        "required": ["term", "schema"]
      }
    },
    "placenames": {
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "placename": { "type": "string" },
          "area": { "type": "string" },
          "country": {
            "description": "Country code like ISO 3611-1, except 'NO' for Norway, including Svalbard and Jan Mayen, Bouvetøya, and Peter I Øy. 'AQ' = Antarctica.",
            "type": ["string", "null"],
            "pattern": "^(([A-Z]|[a-z]){2})$"
          }
        }
      }
    },
    "activity": {
      "type": "array",
      "additionalItems": false,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "start": { "type": ["string", "null"], "format": "date-time" },
          "stop": { "type": ["string", "null"],  "format": "date-time" }
        }
      }
    },
    "quality": { "type": ["string", "null"] },
    "sets": {
      "description": "Subsets",
      "type": "array",
      "additionalItems": false,
      "items": { "type": "string" }
    },
    "gcmd": { "description": "GCMD DIF, see http://gcmd.gsfc.nasa.gov/add/difguide/index.html", "type": "object",
      "properties": {
        "sciencekeywords": {
          "description": "DIF keywords",
          "type": "array",
          "additionalItems": false,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "Category": { "type": "string" },
              "Topic": { "type": "string" },
              "Term": { "type": "string" },
              "Variable_Level_1": { "type": "string" },
              "Variable_Level_2": { "type": "string" },
              "Variable_Level_3": { "type": "string" },
              "Detailed_Variable": { "type": "string" }
            }
          }
        }
      }
    },
    "published": {
      "description": "Metadata was published",
      "type": "string",
      "format": "date-time"
    },
    "updated": {
      "description": "Metadata was updated",
      "type": "string",
      "format": "date-time"
    },
    "comment": { "description": "A free text comment", "type": "string" },
    "source": {
      "description": "Source data",
      "additionalProperties": false,
      "type": ["object", "null"],
      "properties": {
        "schema": { "type": "string" },
        "data": { "type": "object" }
      }
      
    },
    "rights" : { "type": "string" },
    "_id": { "description": "Internal id", "type": "string" },
    "_rev" : { "description": "Internal revision", "type": "string" },
    "publisher": { "type": "string" },
    "collection": { "type": "string" },
    "editor" : {  "type": "string" }
  }
}
